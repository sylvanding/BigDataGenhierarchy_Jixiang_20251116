# Assignment 4 快速开始指南

本指南帮助你快速运行和测试Assignment 4的三种多Pivot树索引实现：3-pivot MVPT、3-pivot CGHT和完全线性划分树。

## 目录

- [快速测试步骤](#快速测试步骤)
- [演示程序说明](#演示程序说明)
- [代码结构说明](#代码结构说明)
- [理论背景](#理论背景)
- [常见问题](#常见问题)

---

## 快速测试步骤

### 第一步：编译项目

```bash
cd BigDataGenhierarchy_Jixiang_20251116
mvn clean compile
```

### 第二步：运行多Pivot树功能演示

```bash
mvn exec:java "-Dexec.mainClass=examples.assignment4.MultiPivotTreeDemo"
```

**你会看到**：

- ✅ MVP树构建过程展示
- ✅ CGH树构建过程展示
- ✅ 完全线性划分树构建过程展示
- ✅ 树结构可视化
- ✅ 范围查询结果验证
- ✅ kNN查询结果验证
- ✅ 与线性扫描结果一致性检验

### 第三步：运行性能对比分析

```bash
mvn exec:java "-Dexec.mainClass=examples.assignment4.MultiPivotPerformanceAnalysis"
```

**你会看到**：

- ✅ 不同数据集上的性能对比
- ✅ 构建时间对比
- ✅ 查询性能对比
- ✅ 剪枝率分析
- ✅ 参数影响分析

---

## 演示程序说明

### MultiPivotTreeDemo.java - 功能演示

该程序展示三种多Pivot树索引的核心功能：

#### 1. 小规模数据演示（便于手工验证）

程序首先使用15个2D点进行演示，输出详细的构建过程：

```
【1. 测试数据集】
--------------------------------------------------
数据类型: 2维向量
距离函数: 欧几里得距离 (L2)
数据数量: 15

数据点列表:
  ID=0: (1.0, 1.0)
  ID=1: (2.0, 2.0)
  ID=2: (3.0, 1.0)
  ID=3: (4.0, 4.0)
  ID=4: (5.0, 2.0)
  ID=5: (6.0, 5.0)
  ID=6: (7.0, 3.0)
  ID=7: (8.0, 6.0)
  ID=8: (9.0, 4.0)
  ID=9: (10.0, 7.0)
  ID=10: (3.0, 5.0)
  ID=11: (6.0, 1.0)
  ID=12: (2.0, 7.0)
  ID=13: (8.0, 2.0)
  ID=14: (4.0, 8.0)
```

#### 2. MVP树构建演示

展示3-pivot嵌套球形划分的过程：

```
【2. MVP树构建演示】
--------------------------------------------------

============================================================
开始构建 3-pivot MVP-Tree (多优势点树)
============================================================
数据集大小: 15
配置: TreeConfig[maxLeafSize=3, minTreeHeight=2, pivotStrategy=FFT, verbose=true, seed=42]
  深度0: 选择支撑点 p1=VectorData[id=5, dim=2, coords=[6.0000, 5.0000]], p2=VectorData[id=0, dim=2, coords=[1.0000, 1.0000]], p3=VectorData[id=9, dim=2, coords=[10.0000, 7.0000]]
  深度0: 数据划分完成，分布=[2, 0, 5, 0, 1, 4, 0, 0]
  深度1: 创建叶子节点，数据量=2
  深度1: 选择支撑点 p1=VectorData[id=13, dim=2, coords=[8.0000, 2.0000]], p2=VectorData[id=14, dim=2, coords=[4.0000, 8.0000]], p3=VectorData[id=7, dim=2, coords=[8.0000, 6.0000]]
  深度1: 数据划分完成，分布=[2, 0, 0, 0, 0, 0, 0, 0]
  深度2: 创建叶子节点，数据量=2
  深度1: 创建叶子节点，数据量=1
  深度1: 选择支撑点 p1=VectorData[id=11, dim=2, coords=[6.0000, 1.0000]], p2=VectorData[id=12, dim=2, coords=[2.0000, 7.0000]], p3=VectorData[id=1, dim=2, coords=[2.0000, 2.0000]]
  深度1: 数据划分完成，分布=[1, 0, 0, 0, 0, 0, 0, 0]
  深度2: 创建叶子节点，数据量=1

构建完成!
----------------------------------------
构建耗时: 4 ms
树高度: 2
总节点数: 7
  - 内部节点: 3
  - 叶子节点: 4
构建距离计算次数: 84
============================================================

MVP树结构:

3-pivot MVP-Tree (多优势点树) 树结构:
--------------------------------------------------
└── MVP内部节点 [pivots=ID5,ID0,ID9, sizes=[2,0,5,0,1,4,0,0]]
    ├── 叶子节点 [数据量=2]
    ├── MVP内部节点 [pivots=ID13,ID14,ID7, sizes=[2,0,0,0,0,0,0,0]]
    │   └── 叶子节点 [数据量=2]
    ├── 叶子节点 [数据量=1]
    └── MVP内部节点 [pivots=ID11,ID12,ID1, sizes=[1,0,0,0,0,0,0,0]]
        └── 叶子节点 [数据量=1]
```

#### 3. CGH树构建演示

展示3-pivot超平面划分的过程：

```
【3. CGH树构建演示】
--------------------------------------------------

============================================================
开始构建 3-pivot CGH-Tree (完全广义超平面树)
============================================================
数据集大小: 15
配置: TreeConfig[maxLeafSize=3, minTreeHeight=2, pivotStrategy=FFT, verbose=true, seed=42]
  深度0: 选择支撑点 p1=VectorData[id=5, dim=2, coords=[6.0000, 5.0000]], p2=VectorData[id=0, dim=2, coords=[1.0000, 1.0000]], p3=VectorData[id=9, dim=2, coords=[10.0000, 7.0000]]
  深度0: 数据划分完成，分布=[8, 2, 2, 0]
  深度1: 选择支撑点 p1=VectorData[id=3, dim=2, coords=[4.0000, 4.0000]], p2=VectorData[id=13, dim=2, coords=[8.0000, 2.0000]], p3=VectorData[id=14, dim=2, coords=[4.0000, 8.0000]]
  深度1: 数据划分完成，分布=[2, 2, 1, 0]
  深度2: 创建叶子节点，数据量=2
  深度2: 创建叶子节点，数据量=2
  深度2: 创建叶子节点，数据量=1
  深度1: 创建叶子节点，数据量=2
  深度1: 创建叶子节点，数据量=2

构建完成!
----------------------------------------
构建耗时: 1 ms
树高度: 2
总节点数: 7
  - 内部节点: 2
  - 叶子节点: 5
构建距离计算次数: 91
============================================================

CGH树结构:

3-pivot CGH-Tree (完全广义超平面树) 树结构:
--------------------------------------------------
└── CGH内部节点 [pivots=ID5,ID0,ID9, sizes=[8,2,2,0]]
    ├── CGH内部节点 [pivots=ID3,ID13,ID14, sizes=[2,2,1,0]]
    │   ├── 叶子节点 [数据量=2]
    │   ├── 叶子节点 [数据量=2]
    │   └── 叶子节点 [数据量=1]
    ├── 叶子节点 [数据量=2]
    └── 叶子节点 [数据量=2]
```

#### 4. 线性划分树构建演示

展示在支撑点空间中的线性划分过程：

```
【4. 线性划分树构建演示】
--------------------------------------------------

============================================================
开始构建 3-pivot Linear-Partition-Tree (完全线性划分树)
============================================================
数据集大小: 15
配置: TreeConfig[maxLeafSize=3, minTreeHeight=2, pivotStrategy=FFT, verbose=true, seed=42]
  深度0: 选择支撑点 p1=VectorData[id=5, dim=2, coords=[6.0000, 5.0000]], p2=VectorData[id=0, dim=2, coords=[1.0000, 1.0000]], p3=VectorData[id=9, dim=2, coords=[10.0000, 7.0000]]
  深度0: 数据划分完成，分布=[2, 0, 5, 0, 1, 4, 0, 0]
  深度1: 创建叶子节点，数据量=2
  深度1: 选择支撑点 p1=VectorData[id=13, dim=2, coords=[8.0000, 2.0000]], p2=VectorData[id=14, dim=2, coords=[4.0000, 8.0000]], p3=VectorData[id=7, dim=2, coords=[8.0000, 6.0000]]
  深度1: 数据划分完成，分布=[2, 0, 0, 0, 0, 0, 0, 0]
  深度2: 创建叶子节点，数据量=2
  深度1: 创建叶子节点，数据量=1
  深度1: 选择支撑点 p1=VectorData[id=11, dim=2, coords=[6.0000, 1.0000]], p2=VectorData[id=12, dim=2, coords=[2.0000, 7.0000]], p3=VectorData[id=1, dim=2, coords=[2.0000, 2.0000]]
  深度1: 数据划分完成，分布=[1, 0, 0, 0, 0, 0, 0, 0]
  深度2: 创建叶子节点，数据量=1

构建完成!
----------------------------------------
构建耗时: 4 ms
树高度: 2
总节点数: 7
  - 内部节点: 3
  - 叶子节点: 4
构建距离计算次数: 84
============================================================

线性划分树结构:

3-pivot Linear-Partition-Tree (完全线性划分树) 树结构:
--------------------------------------------------
└── LP内部节点 [pivots=ID5,ID0,ID9, sizes=[2,0,5,0,1,4,0,0]]
    ├── 叶子节点 [数据量=2]
    ├── LP内部节点 [pivots=ID13,ID14,ID7, sizes=[2,0,0,0,0,0,0,0]]
    │   └── 叶子节点 [数据量=2]
    ├── 叶子节点 [数据量=1]
    └── LP内部节点 [pivots=ID11,ID12,ID1, sizes=[1,0,0,0,0,0,0,0]]
        └── 叶子节点 [数据量=1]
```

#### 5. 范围查询验证

```
【5. 范围查询演示】
--------------------------------------------------
查询点: (5.0, 5.0)
查询半径: 3.0

--- 线性扫描结果（基准） ---
结果数量: 5
距离计算次数: 15
结果详情:
  ID=5: (6.0, 5.0), 距离=1.0000
  ID=3: (4.0, 4.0), 距离=1.4142
  ID=10: (3.0, 5.0), 距离=2.0000
  ID=6: (7.0, 3.0), 距离=2.8284
  ID=4: (5.0, 2.0), 距离=3.0000

--- MVP树范围查询 ---
结果数量: 5
距离计算次数: 15
节点访问次数: 7

--- CGH树范围查询 ---
结果数量: 5
距离计算次数: 13
节点访问次数: 6

--- 线性划分树范围查询 ---
结果数量: 5
距离计算次数: 15
节点访问次数: 7

--- 结果一致性验证 ---
MVP树结果与线性扫描一致: ✓
CGH树结果与线性扫描一致: ✓
线性划分树结果与线性扫描一致: ✓
```

#### 6. kNN查询验证

```
【6. kNN查询演示】
--------------------------------------------------
查询点: (5.0, 5.0)
k = 3

--- MVP树kNN结果 ---
距离计算次数: 11
  #1: ID=5, 距离=1.0000
  #2: ID=3, 距离=1.4142
  #3: ID=10, 距离=2.0000

--- CGH树kNN结果 ---
距离计算次数: 9
  #1: ID=5, 距离=1.0000
  #2: ID=3, 距离=1.4142
  #3: ID=10, 距离=2.0000

--- 线性划分树kNN结果 ---
距离计算次数: 11
  #1: ID=5, 距离=1.0000
  #2: ID=3, 距离=1.4142
  #3: ID=10, 距离=2.0000
```

### MultiPivotPerformanceAnalysis.java - 性能分析

该程序进行全面的性能对比分析：

#### 实验1: 低维向量数据集 (2维)

```
================================================================================
实验1: 低维向量数据集 (2维)
================================================================================

数据集: 聚类2D向量
数据量: 1000
维度: 2

【构建性能】
------------------------------------------------------------
索引类型            | 构建时间(ms)     | 距离计算         | 树高         | 节点数       
-----------------------------------------------------------------
MVP-Tree         | 10           | 14755        | 4          | 242
CGH-Tree         | 4            | 21555        | 7          | 157
LP-Tree          | 5            | 14755        | 4          | 242

【范围查询性能】
------------------------------------------------------------
半径         | 线性扫描         | MVP-Tree     | CGH-Tree     | LP-Tree      | MVP剪枝率     | CGH剪枝率
-----------------------------------------------------------------------------------------------
1.0        | 1000         | 119          | 367          | 218          | 88.1     % | 63.3     %
2.0        | 1000         | 168          | 596          | 371          | 83.2     % | 40.4     %
3.0        | 1000         | 201          | 985          | 594          | 79.9     % | 1.5      %

【kNN查询性能】
------------------------------------------------------------
k      | 线性扫描         | MVP-Tree     | CGH-Tree     | LP-Tree      | MVP剪枝率
---------------------------------------------------------------------------
5      | 1000         | 37           | 457          | 37           | 96.3     %
10     | 1000         | 51           | 538          | 51           | 94.9     %
20     | 1000         | 77           | 558          | 77           | 92.3     %
```

#### 实验2: 高维向量数据集 (10维)

```
================================================================================
实验2: 高维向量数据集 (10维)
================================================================================

数据集: 均匀10D向量
数据量: 500
维度: 10

【构建性能】
------------------------------------------------------------
索引类型            | 构建时间(ms)     | 距离计算         | 树高         | 节点数       
-----------------------------------------------------------------
MVP-Tree         | 2            | 5983         | 3          | 182
CGH-Tree         | 1            | 8694         | 5          | 136
LP-Tree          | 1            | 5983         | 3          | 182

【范围查询性能】
------------------------------------------------------------
半径         | 线性扫描         | MVP-Tree     | CGH-Tree     | LP-Tree      | MVP剪枝率     | CGH剪枝率
-----------------------------------------------------------------------------------------------
2.0        | 500          | 73           | 140          | 73           | 85.4     % | 72.0     %
3.0        | 500          | 113          | 491          | 113          | 77.4     % | 1.8      %
4.0        | 500          | 149          | 492          | 149          | 70.2     % | 1.6      %

【kNN查询性能】
------------------------------------------------------------
k      | 线性扫描         | MVP-Tree     | CGH-Tree     | LP-Tree      | MVP剪枝率
---------------------------------------------------------------------------
5      | 500          | 433          | 500          | 433          | 13.4     %
10     | 500          | 480          | 500          | 480          | 4.0      %
20     | 500          | 482          | 500          | 482          | 3.6      %
```

#### 实验3: 蛋白质序列数据集

```
================================================================================
实验3: 蛋白质序列数据集
================================================================================

数据集: 酵母蛋白质序列
数据量: 960
序列长度: 6

【构建性能】
------------------------------------------------------------
索引类型            | 构建时间(ms)     | 距离计算         | 树高         | 节点数       
-----------------------------------------------------------------
MVP-Tree         | 14           | 12278        | 3          | 109
CGH-Tree         | 9            | 13662        | 4          | 57
LP-Tree          | 6            | 12278        | 3          | 109

【范围查询性能】
------------------------------------------------------------
半径         | 线性扫描         | MVP-Tree     | CGH-Tree     | LP-Tree      | MVP剪枝率
--------------------------------------------------------------------------------
1.0        | 960          | 233          | 515          | 233          | 75.7     %
2.0        | 960          | 767          | 515          | 767          | 20.1     %
3.0        | 960          | 771          | 960          | 771          | 19.7     %
```

#### 实验4: 参数影响分析

```
================================================================================
实验4: 参数影响分析
================================================================================

【4.1 最大叶子节点大小的影响】
------------------------------------------------------------
叶子大小         | MVP高       | CGH高       | LP高        | MVP距离计算       | CGH距离计算
--------------------------------------------------------------------------------
5            | 4          | 7          | 4          | 87           | 299
10           | 4          | 6          | 4          | 112          | 299
25           | 3          | 6          | 3          | 141          | 299
50           | 2          | 4          | 2          | 214          | 299
100          | 2          | 2          | 2          | 214          | 299

【4.2 Pivot选择策略的影响】
------------------------------------------------------------
策略              | MVP构建距离       | CGH构建距离       | MVP查询距离       | CGH查询距离
---------------------------------------------------------------------------
RANDOM          | 3810         | 5895         | 200          | 300
FFT             | 6150         | 8702         | 141          | 299
MAX_SPREAD      | 25679        | 42909        | 168          | 500
```

---

## 代码结构说明

### 新增的核心类

```
src/main/java/
├── index/
│   └── tree/                         # 树索引模块
│       ├── common/
│       │   ├── TreeConfig.java       # 树配置类
│       │   ├── TreeHeightController.java # 树高控制器
│       │   └── MultiPivotSelector.java # 多Pivot选择器 (NEW)
│       ├── mvptree/                  # MVP树实现 (NEW)
│       │   ├── MVPTree.java          # MVP树主类
│       │   └── MVPInternalNode.java  # MVP树内部节点
│       ├── cght/                     # CGH树实现 (NEW)
│       │   ├── CGHTree.java          # CGH树主类
│       │   └── CGHInternalNode.java  # CGH树内部节点
│       └── linearpartition/          # 线性划分树实现 (NEW)
│           ├── LinearPartitionTree.java # 线性划分树主类
│           └── LinearPartitionInternalNode.java # 线性划分树内部节点
└── examples/
    └── assignment4/                  # Assignment 4 演示程序 (NEW)
        ├── MultiPivotTreeDemo.java   # 功能演示程序
        └── MultiPivotPerformanceAnalysis.java # 性能分析程序
```

### 主要类说明

| 类名 | 功能 |
|------|------|
| `MultiPivotSelector` | 多Pivot选择器，支持RANDOM/FFT/MAX_SPREAD策略 |
| `MVPTree` | 3-pivot MVP树实现，使用嵌套球形划分 |
| `MVPInternalNode` | MVP树内部节点，包含3个pivot和8个子树 |
| `CGHTree` | 3-pivot CGHT实现，使用完全超平面划分 |
| `CGHInternalNode` | CGH树内部节点，基于距离差划分为4个区域 |
| `LinearPartitionTree` | 3-pivot 完全线性划分树，在支撑点空间中划分 |
| `LinearPartitionInternalNode` | 线性划分树内部节点，8个子区域 |

### 使用示例

```java
// 配置树参数
TreeConfig config = new TreeConfig.Builder()
        .maxLeafSize(50)           // 最大叶子节点容量
        .minTreeHeight(2)          // 最小树高
        .pivotStrategy(TreeConfig.PivotSelectionStrategy.FFT)  // FFT策略
        .randomSeed(42)            // 固定随机种子（可选）
        .verbose(false)            // 是否输出详细信息
        .build();

// 创建多Pivot选择器
MultiPivotSelector selector = new MultiPivotSelector(
    MultiPivotSelector.SelectionStrategy.FFT, 42);

// 创建MVP树
MVPTree mvpTree = new MVPTree(config, selector);
mvpTree.buildIndex(dataset, new MinkowskiDistance(2));

// 创建CGH树
CGHTree cghTree = new CGHTree(config, selector);
cghTree.buildIndex(dataset, new MinkowskiDistance(2));

// 创建线性划分树
LinearPartitionTree lpTree = new LinearPartitionTree(config, selector);
lpTree.buildIndex(dataset, new MinkowskiDistance(2));

// 范围查询
List<MetricSpaceData> results = mvpTree.rangeQuery(queryObject, radius);

// kNN查询
List<MetricSpaceData> knnResults = cghTree.knnQuery(queryObject, k);

// 获取统计信息
System.out.println(lpTree.getStatistics());
```

---

## 理论背景

### 3-pivot MVP树 (Multiple Vantage Point Tree)

**核心思想**：使用3个支撑点(pivot)进行嵌套球形划分，将空间分为8个子区域。

**划分规则**：

- 对于数据点x，计算到3个pivot的距离：d1, d2, d3
- 计算每个pivot维度的中位数作为划分边界
- 根据d1, d2, d3与中位数的比较确定子区域（2³=8个）

**剪枝规则**（范围查询，半径r）：

对于子区域i，其距离范围为[L_j, U_j]（j=1,2,3）：

- 如果存在j使得 dq_j + r < L_j 或 dq_j - r > U_j，可以剪枝

**包含规则**：

- 如果存在j使得 dq_j + U_j <= r，子区域完全在查询范围内

### 3-pivot CGHT (Complete Generalized Hyperplane Tree)

**核心思想**：使用3个支撑点定义的距离差进行超平面划分。

**划分规则**：

- 计算距离差：delta12 = d1 - d2, delta13 = d1 - d3
- 根据距离差的符号划分为4个区域：
  - 区域0: delta12 < 0, delta13 < 0
  - 区域1: delta12 >= 0, delta13 < 0
  - 区域2: delta12 < 0, delta13 >= 0
  - 区域3: delta12 >= 0, delta13 >= 0

**剪枝规则**：

基于GH树剪枝规则的扩展：

- 若 delta12_q - 2r > 子区域delta12上界，排除
- 若 delta12_q + 2r < 子区域delta12下界，排除
- 类似地检查delta13

### 3-pivot 完全线性划分树

**核心思想**：将数据映射到3维支撑点空间(d1, d2, d3)，使用正交线性超平面划分。

**划分规则**：

- 数据坐标: (d1, d2, d3) = (d(x,p1), d(x,p2), d(x,p3))
- 使用各维度中位数作为划分阈值
- 产生2³=8个子区域

**剪枝规则**：

在支撑点空间中，范围查询(q, r)对应的区域是边长2r的立方体：

- 若子区域与查询立方体不相交，可排除

### 三种索引的对比

| 特性 | MVP树 | CGH树 | 线性划分树 |
|------|-------|-------|------------|
| 划分空间 | 度量空间 | 度量空间 | 支撑点空间 |
| 划分依据 | 距离值 d(x,p) | 距离差 d(x,p1)-d(x,p2) | 距离向量 (d1,d2,d3) |
| 划分边界形状 | 球面 | 超平面 | 线性超平面 |
| 子区域数 | 8 (=2³) | 4 | 8 (=2³) |
| 剪枝条件 | 距离范围 | 距离差范围 | 坐标范围 |
| 包含规则 | 有 | 无 | 有（近似） |

---

## 常见问题

### Q1: 为什么使用3个pivot而不是更多？

A: 3-pivot是一个平衡点：

- 2个pivot（如GH树）的剪枝能力有限
- 更多pivot会增加计算开销和存储空间
- 3-pivot提供2³=8个子区域，剪枝能力较好
- 更多pivot可能导致子区域过小或为空

### Q2: 三种索引各自的优势是什么？

A:

- **MVP树优势**：球形划分直观，有包含规则可批量返回结果
- **CGH树优势**：利用距离差信息，剪枝规则与GH树一脉相承
- **线性划分树优势**：在支撑点空间中划分，剪枝条件清晰直观

### Q3: 如何选择合适的参数？

A:

- `maxLeafSize`：通常设置为数据量的1/50到1/20，太小会导致树太深
- `minTreeHeight`：根据任务要求设置，一般2-3层即可
- `pivotStrategy`：推荐使用FFT策略，在效果和效率之间取得平衡

### Q4: 为什么CGH树只有4个子区域而其他两个有8个？

A: CGH树使用距离差划分，只需要两个独立变量(delta12, delta13)即可表示所有信息。每个变量按符号划分为2部分，共2²=4个区域。若需要8个区域，可以进一步考虑delta23的符号。

### Q5: 如何验证实现的正确性？

A: 运行MultiPivotTreeDemo程序或单元测试，程序会自动将三种索引的查询结果与线性扫描结果对比，验证一致性。

---

## 单元测试

### 测试类说明

| 测试类 | 说明 |
|--------|------|
| `MultiPivotTreeTest` | 三种多Pivot树的综合测试 |

### 运行测试

```bash
# 运行所有测试
mvn test

# 只运行Assignment 4相关测试
mvn test "-Dtest=MultiPivotTreeTest"
```

### 测试结果示例

运行 `mvn test "-Dtest=MultiPivotTreeTest"` 后，你会看到类似如下输出：

```
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running index.tree.MultiPivotTreeTest

============================================================
多Pivot树索引测试
============================================================

=== 测试1: MVP树构建 ===
构建成功!
  树高度: 2
  总节点数: 7
  叶子节点数: 4
  构建距离计算: 84
测试通过！


=== 测试2: MVP树范围查询 ===
查询点: (5.0, 5.0)
查询半径: 3.0
结果数量: 5
距离计算次数: 15
测试通过！


=== 测试3: MVP树kNN查询 ===
查询点: (5.0, 5.0)
k = 3
结果:
  #1: ID=5, 距离=1.0000
  #2: ID=3, 距离=1.4142
  #3: ID=10, 距离=2.0000
测试通过！


=== 测试4: CGH树构建 ===
构建成功!
  树高度: 2
  总节点数: 7
  叶子节点数: 5
  构建距离计算: 91
测试通过！


=== 测试5: CGH树范围查询 ===
查询点: (5.0, 5.0)
查询半径: 3.0
结果数量: 5
距离计算次数: 13
测试通过！


=== 测试6: CGH树kNN查询 ===
查询点: (5.0, 5.0)
k = 3
结果:
  #1: ID=5, 距离=1.0000
  #2: ID=3, 距离=1.4142
  #3: ID=10, 距离=2.0000
测试通过！


=== 测试7: 线性划分树构建 ===
构建成功!
  树高度: 2
  总节点数: 7
  叶子节点数: 4
  构建距离计算: 84
测试通过！


=== 测试8: 线性划分树范围查询 ===
查询点: (5.0, 5.0)
查询半径: 3.0
结果数量: 5
距离计算次数: 15
测试通过！


=== 测试9: 线性划分树kNN查询 ===
查询点: (5.0, 5.0)
k = 3
结果:
  #1: ID=5, 距离=1.0000
  #2: ID=3, 距离=1.4142
  #3: ID=10, 距离=2.0000
测试通过！


=== 测试10: 三种索引结果一致性 ===
查询点: (5.0, 5.0)
查询半径: 3.0
MVP树结果数: 5
CGH树结果数: 5
线性划分树结果数: 5
结果一致性: ✓
测试通过！


=== 测试11: 较大数据集测试 ===
数据集大小: 200
MVP树: 高度=2, 节点数=56
CGH树: 高度=5, 节点数=55
线性划分树: 高度=2, 节点数=56
正确率: 10/10 (100.0%)
测试通过！


=== 测试12: 空数据集处理 ===
正确抛出异常！
测试通过！

[INFO] Tests run: 12, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.115 s -- in index.tree.MultiPivotTreeTest
[INFO] 
[INFO] Results:
[INFO]
[INFO] Tests run: 12, Failures: 0, Errors: 0, Skipped: 0
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  2.657 s
[INFO] Finished at: 2026-01-11T14:42:27+08:00
[INFO] ------------------------------------------------------------------------
```

---

## 运行命令汇总

```bash
# 编译项目
mvn clean compile

# 运行功能演示
mvn exec:java "-Dexec.mainClass=examples.assignment4.MultiPivotTreeDemo"

# 运行性能分析
mvn exec:java "-Dexec.mainClass=examples.assignment4.MultiPivotPerformanceAnalysis"

# 只运行Assignment 4相关测试
mvn test "-Dtest=MultiPivotTreeTest"
```

---

## 相关文档

- [Assignment 4 需求文档](../Assignment4/Assignment4-Requirements.md)
- [项目整体架构规划](../tasks/Assignment4/00-项目整体架构规划.md)
- [详细任务分解](../tasks/Assignment4/01-Assignment4-详细任务分解.md)
- [理论基础整理](../tasks/Assignment4/02-理论基础整理.md)

---

## 版本信息

- **版本**: 1.0
- **更新日期**: 2026-01-11
- **作者**: Jixiang Ding
